
#include <time.h>
#include <glib.h>
#include <stdlib.h>
#include <stdio.h>
#include <sensor.h>
#include <sensors.h>

#define MICROSECONDS(tv)        ((tv.tv_sec * 1000000ll) + tv.tv_usec)

static GMainLoop *mainloop;

void test_facedown_cb( unsigned long long timestamp, void *user_data)
{
	printf("face down\n\n");
}


int main()
{

	sensor_type_e type = SENSOR_MOTION_FACEDOWN;
	sensor_h handle;
	unsigned long long time_old;


	bool is_supported;

	float max = 0, min = 0, res = 0;
	mainloop = g_main_loop_new(NULL, FALSE);

	if(sensor_is_supported(type, &is_supported) != SENSOR_ERROR_NONE){

		printf("unknown error\n");
		return 0;
	}
	if(!is_supported){
		printf("unsupported sensor\n");
		return 0;
	}

	sensor_create(&handle);


	sensor_motion_facedown_set_cb(handle, test_facedown_cb, NULL);


	if(sensor_start(handle, type) == SENSOR_ERROR_NONE)
	{
		printf("Success start \n");
	}
	else
	{
		printf("Fail start\n\n");
		sensor_motion_facedown_unset_cb(handle);
		sensor_destroy(handle);
		return -1;
	}


	g_main_loop_run(mainloop);
	g_main_loop_unref(mainloop);

	sensor_motion_facedown_unset_cb(handle);

	if(sensor_stop(handle, type) == SENSOR_ERROR_NONE)
		printf("Success stop \n");

	sensor_destroy(handle);
	return 0;
}
