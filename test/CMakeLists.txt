CMAKE_MINIMUM_REQUIRED(VERSION 2.6)
project(sensor-tc C)

SET(PREFIX ${CMAKE_INSTALL_PREFIX})
SET(EXEC_PREFIX "\${prefix}")
SET(LIBDIR "\${prefix}/lib")
SET(INCLUDEDIR "\${prefix}/include")
SET(VERSION 1.0)

INCLUDE(FindPkgConfig)
pkg_check_modules(pkgs REQUIRED glib-2.0 dlog)

add_definitions(${rpkgs_CFLAGS})
add_definitions(-DPREFIX="${CMAKE_INSTALL_PREFIX}")

configure_file(${PROJECT_NAME}.pc.in ${CMAKE_CURRENT_SOURCE_DIR}/${PROJECT_NAME}.pc @ONLY)

include_directories(${CMAKE_CURRENT_SOURCE_DIR})
include_directories(${CMAKE_SOURCE_DIR}/src/libsensord)
include_directories(${CMAKE_SOURCE_DIR}/src/shared)

FOREACH(flag ${pkgs_CFLAGS})
	SET(EXTRA_CFLAGS "${EXTRA_CFLAGS} ${flag}")
ENDFOREACH(flag)

SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${EXTRA_CFLAGS}")

link_directories(../src/libsensord/)

add_executable(accelerometer src/accelerometer.c)
add_executable(geomagnetic src/geomagnetic.c)
add_executable(orientation src/orientation.c)
add_executable(gravity src/gravity.c)
add_executable(linear_acceleration src/linear_acceleration.c)
add_executable(gyro src/gyro.c)
add_executable(proxi src/proxi.c)
add_executable(pressure src/pressure.c)
add_executable(temperature src/temperature.c)
add_executable(light src/light.c)

SET_TARGET_PROPERTIES(accelerometer PROPERTIES LINKER_LANGUAGE C)
SET_TARGET_PROPERTIES(geomagnetic PROPERTIES LINKER_LANGUAGE C)
SET_TARGET_PROPERTIES(orientation PROPERTIES LINKER_LANGUAGE C)
SET_TARGET_PROPERTIES(gravity PROPERTIES LINKER_LANGUAGE C)
SET_TARGET_PROPERTIES(linear_acceleration PROPERTIES LINKER_LANGUAGE C)
SET_TARGET_PROPERTIES(gyro PROPERTIES LINKER_LANGUAGE C)
SET_TARGET_PROPERTIES(proxi PROPERTIES LINKER_LANGUAGE C)
SET_TARGET_PROPERTIES(pressure PROPERTIES LINKER_LANGUAGE C)
SET_TARGET_PROPERTIES(temperature PROPERTIES LINKER_LANGUAGE C)
SET_TARGET_PROPERTIES(light PROPERTIES LINKER_LANGUAGE C)

target_link_libraries(accelerometer glib-2.0 dlog sensor)
target_link_libraries(geomagnetic glib-2.0 dlog sensor)
target_link_libraries(orientation glib-2.0 dlog sensor)
target_link_libraries(gravity glib-2.0 dlog sensor)
target_link_libraries(linear_acceleration glib-2.0 dlog sensor)
target_link_libraries(gyro glib-2.0 dlog sensor)
target_link_libraries(proxi glib-2.0 dlog sensor)
target_link_libraries(pressure glib-2.0 dlog sensor)
target_link_libraries(temperature glib-2.0 dlog sensor)
target_link_libraries(light glib-2.0 dlog sensor)

INSTALL(TARGETS accelerometer DESTINATION /usr/bin/)
INSTALL(TARGETS geomagnetic DESTINATION /usr/bin/)
INSTALL(TARGETS orientation DESTINATION /usr/bin/)
INSTALL(TARGETS gravity DESTINATION /usr/bin/)
INSTALL(TARGETS linear_acceleration DESTINATION /usr/bin/)
INSTALL(TARGETS gyro DESTINATION /usr/bin/)
INSTALL(TARGETS proxi DESTINATION /usr/bin/)
INSTALL(TARGETS pressure DESTINATION /usr/bin/)
INSTALL(TARGETS temperature DESTINATION /usr/bin/)
INSTALL(TARGETS light DESTINATION /usr/bin/)

